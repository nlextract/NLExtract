BRK inlezen met Stetl (www.stetl.org) ETL framework.
door: Just van den Broecke en Frank Steggink
GFS en XSLT door Just van den Broecke en Frank Steggink

Deze map bevat de ETL configuratie en commando om via Stetl
BRK vanuit de bron GML bestanden (gezipt) naar verschillende outputs weg te schrijven.
Standaard is dit PostGIS, maar omdat output via ogr2ogr verloopt kan dit
elke output zijn die ogr2ogr ondersteunt, bijv SHP, GeoJSON of GeoPackage, in theorie ook bijv Oracle.

Om gebruik te maken van Stetl moet de externe GitHub submodule externals/stetl
aanwezig zijn.

Bij het klonen van de GitHub komt Stetl als volgt mee:
git clone --recursive https://github.com/opengeogroep/NLExtract.git
Stetl komt dan mee, hoeft niet apart geinstalleerd, alleen de Stetl-dependencies.

Dependencies Stetl installeren:
http://www.stetl.org/en/latest/install.html

Meer over Stetl: http://stetl.org

Downloaden GML
--------------

Met het hulpscript download-brk.sh <doel map> kan de BRK-DKK eerst gedownload worden naar een doel map.
NB, soms zijn de gedonwloade files 0 bytes. Oorzaak is vreemd HTTPS probleem PDOK vermoedelijk.

Commando
--------

./etl-brk.sh

Gebruikt default opties (database params etc) uit options/default.args

Stetl configuratie, hoeft niet gewijzigd, alleen indien bijv andere output gewenst:
conf/etl-brk.cfg

Opties/argumenten
-----------------

Een aantal opties kunnen op 2 manieren vervangen worden:

1- Impliciet: Overrule default opties (database params etc) met een eigen lokale file gebaseerd op lokale hostnaam:
options/<jouw host naam>.args

2- Expliciet op command line via  ./etl-brk.sh <mijn opties file>.args

Indien methode 2 gebruikt wordt prevaleert deze boven 1 en de default opties!

Database mapping
----------------
gfs/brk.gfs is GDAL/OGR "GFS Template" en bepaalt de mapping van GML elementen/attributen naar PostGIS kolom(namen).
Maak evt eigen GFS file en specificeer deze in je options/<jouw host naam>.args: bijv gfs_template=gfs/mijnbrk.gfs

TODO
----

Windows (.bat) scripts: etl-brk.cmd (nog niet gemaakt en getest)

GUI

